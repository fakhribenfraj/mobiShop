{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/fbenfraj/Desktop/Home/tekup/angular/mniProjet/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class CartService {\n  constructor(http) {\n    this.http = http;\n    this.items = [];\n    this.carts = [];\n    this.cart = {\n      id: 0,\n      userId: 0,\n      products: [// { product: { description: \"\", id: 0, name: \"\", price: 0 }, amount: 0 },\n      ],\n      totalPrice: 0,\n      totalProducts: 0\n    };\n  }\n\n  addToCart(product, amount) {\n    if (amount === 0) return;\n    let item = this.cart.products.find(item => product.id === item.product.id);\n\n    if (item) {\n      item.amount += amount;\n    } else {\n      this.cart.products.push({\n        product: product,\n        amount: amount\n      });\n    }\n\n    this.cart.totalPrice += product.price;\n    this.calculateTotalProduct();\n  }\n\n  calculateTotalProduct() {\n    this.cart.totalProducts = this.cart.products.reduce((prev, item) => prev + item.amount, 0);\n  }\n\n  getCart() {\n    return this.cart;\n  }\n\n  getCartAmount() {\n    return this.cart.totalProducts;\n  }\n\n  getProducts() {\n    return this.cart.products;\n  }\n\n  clearCart() {\n    this.cart.products = [];\n    this.cart.totalProducts = 0;\n    return this.cart.products;\n  }\n\n  getShippingPrices() {\n    return this.http.get(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/shipping.json\");\n  }\n\n  getCarts() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.http.get(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/carts.json\").subscribe(res => {\n        _this.carts = res;\n      });\n      return _this.carts;\n    })();\n  }\n\n  submitCart(id) {\n    this.cart.id++;\n    this.cart.userId = id;\n    this.carts.push(this.cart);\n    return this.http.put(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/carts.json\", this.carts).subscribe(response => {\n      console.log(response);\n    });\n  }\n\n}\n\nCartService.ɵfac = function CartService_Factory(t) {\n  return new (t || CartService)(i0.ɵɵinject(i1.HttpClient));\n};\n\nCartService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CartService,\n  factory: CartService.ɵfac,\n  providedIn: \"root\"\n});","map":{"version":3,"sources":["C:/Users/fbenfraj/Desktop/Home/tekup/angular/mniProjet/src/app/services/cart.service.ts"],"names":["i0","i1","CartService","constructor","http","items","carts","cart","id","userId","products","totalPrice","totalProducts","addToCart","product","amount","item","find","push","price","calculateTotalProduct","reduce","prev","getCart","getCartAmount","getProducts","clearCart","getShippingPrices","get","getCarts","subscribe","res","submitCart","put","response","console","log","ɵfac","CartService_Factory","t","ɵɵinject","HttpClient","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":"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","sourcesContent":["import * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/common/http\";\r\nexport class CartService {\r\n    constructor(http) {\r\n        this.http = http;\r\n        this.items = [];\r\n        this.carts = [];\r\n        this.cart = {\r\n            id: 0,\r\n            userId: 0,\r\n            products: [\r\n            // { product: { description: \"\", id: 0, name: \"\", price: 0 }, amount: 0 },\r\n            ],\r\n            totalPrice: 0,\r\n            totalProducts: 0,\r\n        };\r\n    }\r\n    addToCart(product, amount) {\r\n        if (amount === 0)\r\n            return;\r\n        let item = this.cart.products.find((item) => product.id === item.product.id);\r\n        if (item) {\r\n            item.amount += amount;\r\n        }\r\n        else {\r\n            this.cart.products.push({ product: product, amount: amount });\r\n        }\r\n        this.cart.totalPrice += product.price;\r\n        this.calculateTotalProduct();\r\n    }\r\n    calculateTotalProduct() {\r\n        this.cart.totalProducts = this.cart.products.reduce((prev, item) => prev + item.amount, 0);\r\n    }\r\n    getCart() {\r\n        return this.cart;\r\n    }\r\n    getCartAmount() {\r\n        return this.cart.totalProducts;\r\n    }\r\n    getProducts() {\r\n        return this.cart.products;\r\n    }\r\n    clearCart() {\r\n        this.cart.products = [];\r\n        this.cart.totalProducts = 0;\r\n        return this.cart.products;\r\n    }\r\n    getShippingPrices() {\r\n        return this.http.get(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/shipping.json\");\r\n    }\r\n    async getCarts() {\r\n        await this.http\r\n            .get(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/carts.json\")\r\n            .subscribe((res) => {\r\n            this.carts = res;\r\n        });\r\n        return this.carts;\r\n    }\r\n    submitCart(id) {\r\n        this.cart.id++;\r\n        this.cart.userId = id;\r\n        this.carts.push(this.cart);\r\n        return this.http\r\n            .put(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/carts.json\", this.carts)\r\n            .subscribe((response) => {\r\n            console.log(response);\r\n        });\r\n    }\r\n}\r\nCartService.ɵfac = function CartService_Factory(t) { return new (t || CartService)(i0.ɵɵinject(i1.HttpClient)); };\r\nCartService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CartService, factory: CartService.ɵfac, providedIn: \"root\" });\r\n"]},"metadata":{},"sourceType":"module"}