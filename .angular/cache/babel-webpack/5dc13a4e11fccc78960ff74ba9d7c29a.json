{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/fbenfraj/Desktop/Home/tekup/angular/mniProjet/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class CartService {\n  constructor(http) {\n    this.http = http;\n    this.items = [];\n    this.carts = [];\n    this.cart = {\n      id: 0,\n      userId: 0,\n      products: [// { product: { description: \"\", id: 0, name: \"\", price: 0 }, amount: 0 },\n      ],\n      totalPrice: 0,\n      totalProducts: 0\n    };\n  }\n\n  addToCart(product, amount) {\n    if (amount === 0) return;\n    let item = this.cart.products.find(item => product.id === item.product.id);\n\n    if (item) {\n      item.amount += amount;\n    } else {\n      this.cart.products.push({\n        product: product,\n        amount: amount\n      });\n    }\n\n    this.cart.totalPrice += product.price * amount;\n    this.calculateTotalProduct();\n  }\n\n  calculateTotalProduct() {\n    this.cart.totalProducts = this.cart.products.reduce((prev, item) => prev + item.amount, 0);\n    this.cart.totalPrice = this.cart.products.reduce((prev, item) => prev + item.product.price * item.amount, 0);\n  }\n\n  deleteFromCart(id) {\n    // let filteredList = this.cart.products.filter(\n    //   (item) => id !== item.product.id\n    // );\n    // this.cart.products = filteredList;\n    let item = this.cart.products.find(item => id === item.product.id);\n\n    if (item) {\n      if (item.amount > 1) {\n        item.amount--; // this.cart.totalPrice -= item.product.price;\n        // this.calculateTotalProduct();\n      } else {\n        // this.cart.totalPrice -= item.product.price;\n        this.cart.products = this.cart.products.filter(item => id !== item.product.id);\n      } // this.cart.totalPrice -= item.product.price;\n\n\n      this.calculateTotalProduct();\n    }\n  }\n\n  getCart() {\n    return this.cart;\n  }\n\n  getCartAmount() {\n    return this.cart.totalProducts;\n  }\n\n  getProducts() {\n    return this.cart.products;\n  }\n\n  clearCart() {\n    this.cart.products = [];\n    this.cart.totalProducts = 0;\n    this.cart.totalPrice = 0;\n    return this.cart.products;\n  }\n\n  getShippingPrices() {\n    return this.http.get(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/shipping.json\");\n  }\n\n  getCarts() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.http.get(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/carts.json\").subscribe(res => {\n        _this.carts = res;\n      });\n      return _this.carts;\n    })();\n  }\n\n  submitCart(id) {\n    this.cart.id++;\n    this.cart.userId = id;\n    this.carts.push(this.cart);\n    return this.http.put(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/carts.json\", this.carts).subscribe(response => {\n      console.log(response);\n    });\n  }\n\n}\n\nCartService.ɵfac = function CartService_Factory(t) {\n  return new (t || CartService)(i0.ɵɵinject(i1.HttpClient));\n};\n\nCartService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CartService,\n  factory: CartService.ɵfac,\n  providedIn: \"root\"\n});","map":{"version":3,"sources":["C:/Users/fbenfraj/Desktop/Home/tekup/angular/mniProjet/src/app/services/cart.service.ts"],"names":["i0","i1","CartService","constructor","http","items","carts","cart","id","userId","products","totalPrice","totalProducts","addToCart","product","amount","item","find","push","price","calculateTotalProduct","reduce","prev","deleteFromCart","filter","getCart","getCartAmount","getProducts","clearCart","getShippingPrices","get","getCarts","subscribe","res","submitCart","put","response","console","log","ɵfac","CartService_Factory","t","ɵɵinject","HttpClient","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":"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","sourcesContent":["import * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/common/http\";\r\nexport class CartService {\r\n    constructor(http) {\r\n        this.http = http;\r\n        this.items = [];\r\n        this.carts = [];\r\n        this.cart = {\r\n            id: 0,\r\n            userId: 0,\r\n            products: [\r\n            // { product: { description: \"\", id: 0, name: \"\", price: 0 }, amount: 0 },\r\n            ],\r\n            totalPrice: 0,\r\n            totalProducts: 0,\r\n        };\r\n    }\r\n    addToCart(product, amount) {\r\n        if (amount === 0)\r\n            return;\r\n        let item = this.cart.products.find((item) => product.id === item.product.id);\r\n        if (item) {\r\n            item.amount += amount;\r\n        }\r\n        else {\r\n            this.cart.products.push({ product: product, amount: amount });\r\n        }\r\n        this.cart.totalPrice += product.price * amount;\r\n        this.calculateTotalProduct();\r\n    }\r\n    calculateTotalProduct() {\r\n        this.cart.totalProducts = this.cart.products.reduce((prev, item) => prev + item.amount, 0);\r\n        this.cart.totalPrice = this.cart.products.reduce((prev, item) => prev + item.product.price * item.amount, 0);\r\n    }\r\n    deleteFromCart(id) {\r\n        // let filteredList = this.cart.products.filter(\r\n        //   (item) => id !== item.product.id\r\n        // );\r\n        // this.cart.products = filteredList;\r\n        let item = this.cart.products.find((item) => id === item.product.id);\r\n        if (item) {\r\n            if (item.amount > 1) {\r\n                item.amount--;\r\n                // this.cart.totalPrice -= item.product.price;\r\n                // this.calculateTotalProduct();\r\n            }\r\n            else {\r\n                // this.cart.totalPrice -= item.product.price;\r\n                this.cart.products = this.cart.products.filter((item) => id !== item.product.id);\r\n            }\r\n            // this.cart.totalPrice -= item.product.price;\r\n            this.calculateTotalProduct();\r\n        }\r\n    }\r\n    getCart() {\r\n        return this.cart;\r\n    }\r\n    getCartAmount() {\r\n        return this.cart.totalProducts;\r\n    }\r\n    getProducts() {\r\n        return this.cart.products;\r\n    }\r\n    clearCart() {\r\n        this.cart.products = [];\r\n        this.cart.totalProducts = 0;\r\n        this.cart.totalPrice = 0;\r\n        return this.cart.products;\r\n    }\r\n    getShippingPrices() {\r\n        return this.http.get(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/shipping.json\");\r\n    }\r\n    async getCarts() {\r\n        await this.http\r\n            .get(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/carts.json\")\r\n            .subscribe((res) => {\r\n            this.carts = res;\r\n        });\r\n        return this.carts;\r\n    }\r\n    submitCart(id) {\r\n        this.cart.id++;\r\n        this.cart.userId = id;\r\n        this.carts.push(this.cart);\r\n        return this.http\r\n            .put(\"https://miniprojet-d7f08-default-rtdb.europe-west1.firebasedatabase.app/carts.json\", this.carts)\r\n            .subscribe((response) => {\r\n            console.log(response);\r\n        });\r\n    }\r\n}\r\nCartService.ɵfac = function CartService_Factory(t) { return new (t || CartService)(i0.ɵɵinject(i1.HttpClient)); };\r\nCartService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CartService, factory: CartService.ɵfac, providedIn: \"root\" });\r\n"]},"metadata":{},"sourceType":"module"}